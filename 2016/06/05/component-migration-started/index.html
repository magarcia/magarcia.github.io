<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head"/><title class="next-head">magarcia</title><link rel="preload" href="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/post.js" as="script"/><link rel="preload" href="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/_error.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-1c1c3136e0f7012e8706.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.fe229520576991e872e2.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.b51f4f1115dec62a42ce.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-a455fdec3098400745ef.js" as="script"/><link rel="stylesheet" href="/_next/static/css/styles.48128712.chunk.css"/><style id="__jsx-1828670626">aside.jsx-1828670626{position:fixed;top:150px;margin-left:-100px;visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 0.3s,opacity 0.3s 0s;transition:visibility 0s linear 0.3s,opacity 0.3s 0s;}
aside.visible.jsx-1828670626{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 0.3s 0s;transition:visibility 0s linear 0s,opacity 0.3s 0s;}
aside.jsx-1828670626 a.jsx-1828670626{font-size:17px;color:rgba(0,0,0,0.84);opacity:0.65;display:block;position:relative;background:rgba(0,0,0,0);-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none;box-sizing:border-box;margin:10px 3px;}
aside.jsx-1828670626 a.jsx-1828670626:hover{opacity:1;}
.ssr-animation.jsx-1828670626{-webkit-animation-delay:2s;animation-delay:2s;-webkit-animation-duration:0.3s;animation-duration:0.3s;-webkit-animation-name:toggle-jsx-1828670626;animation-name:toggle-jsx-1828670626;-webkit-animation-iteration-count:1;animation-iteration-count:1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}
@-webkit-keyframes toggle-jsx-1828670626{from{visibility:hidden;opacity:0;}to{visibility:visible;opacity:1;}}
@keyframes toggle-jsx-1828670626{from{visibility:hidden;opacity:0;}to{visibility:visible;opacity:1;}}</style><link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i|Open+Sans:600|Playfair+Display:700" rel="stylesheet"/></head><body><div id="__next"><div class="components-___bar___7MxMj"><div class="components-___content___HrAga"><div class="components-___block___9skge"><a href="/"><h1 class="components-___title___1CN1y">magarcia</h1></a></div><div class="components-___block___9skge components-___right___1Sapt"><img alt="Gravatar for newluxfero@gmail.com" src="//www.gravatar.com/avatar/eaf59739836cc2f138c202d05256323d?d=retro&amp;r=g&amp;s=48" srcSet="//www.gravatar.com/avatar/eaf59739836cc2f138c202d05256323d?d=retro&amp;r=g&amp;s=96 2x" height="48" width="48" class="react-gravatar components-___avatar___1cxk3"/></div></div></div><section class="components-___body___1FoQ0"><div class="components-___inner___J7ZR7"><article class="pages-___article___1w_PM"><h1 class="pages-___title___3e1JJ">Components migration started</h1><div class="components-___postMetaInline___1GBEP "><time dateTime="1465077600000">Jun 5, 2016</time><span class="components-___middotDivider___yt1kO"></span><span class="components-___readingTime___1s3hq" title="3 min read"></span></div><div class="components-___postContent___3mFwM"><p>Another week finished. This past week I could not do as much as I would have
liked. I still at exam time, so I had to spend much of the time studying. But
even so, there has been significant progress with regard to the project. We
have four important points:</p>
<ol>
<li>Fixed the build process for production.</li>
<li>Added test runner.</li>
<li>Migrated the first component to Angular 2.</li>
<li>Added first test for migrated component.</li>
</ol>
<h2>Fixing the build process</h2>
<p>Last week we had the development environment ready and also, presumably, the
environment for distribute builds. But throughout the week, I noticed that with
distribute build, Jangouts have issues with grid elements inside the video chat
room. After a while trying different configurations for Webpack, I found that
the issues was mainly related with the uglify process.</p>
<p>The issue was related with the grid layout system of the video room, which is
implemented using <a href="http://manifestwebdesign.github.io/angular-gridster/">angular-gridster</a>.
So, the problem can come form angular-gridster style or the JavaScript module.
First at all I tried to import directly the CSS of the library without load it
with Webpack. This didn&#x27;t solve anything. Finally I found that instead of include
the minified version of the library in <code>vendors.ts</code> file, I should use the source
version.</p>
<p>This is a little weird, source and minified version should works equally.
Regardless of this, using the source version fix the issue and this will not be
a problem because Webpack minify all the code, including <code>vendor.ts</code>.</p>
<h2>Adding test runner</h2>
<p>This was easier than I expected. I use the awesome project
<a href="https://github.com/AngularClass/angular2-webpack-starter">angular2-webpack-starter</a>
from <a href="https://angularclass.com/">@AngularClass</a> as a inspiration source for
implement the test runner in Jangouts. I get the files <code>webpack.test.js</code> and
<code>karma.conf.js</code> and, after some small changes, all worked perfectly. This is one
of the best things of open source community: Don&#x27;t Repeat Yourself.</p>
<h2>Migrating first component</h2>
<p>I was waiting for this moment since I sent my proposal to GSoC. I started with
the migration  of a simple component, probably the simplest component of whole
Jangouts, the footer. The footer in Jangouts only shows a link to
<a href="https://www.suse.com/">SUSE</a> and the version of Jangouts.</p>
<p>In the old Jangouts (I will start to differencate between pre and post migration
process) the footer component was composed by a simple Angular 1 directive with
a template and a <a href="http://jade-lang.com/"><code>jade</code></a> template, that was rendered by
gulp adding the current version.</p>
<p>The new footer component is equally simple. It&#x27;s a <a href="https://github.com/magarcia/jangouts/blob/5db2d9de547d6d56aaed90c633b5d98ce64f6219/src/app/components/footer/jh-footer.directive.ts">TypeScript file</a>
(a component definition with an empty class) and an <a href="https://github.com/magarcia/jangouts/blob/5db2d9de547d6d56aaed90c633b5d98ce64f6219/src/app/components/footer/jh-footer.html">Angular 2 template</a>.
But has a difference with the previous version, neither gulp or any other thing
modifies the template for add the version. Instead the previous solution, now
Webpack with the <a href="https://webpack.github.io/docs/list-of-plugins.html#defineplugin">DefinePlugin</a>
add the version as a global constant during the build process, reading the
<code>package.json</code>.</p>
<p>This has a couple of benefits. First, the footer is now a pure Angular component
and, in the other hand, its more easy to test.</p>
<h2>Adding tests</h2>
<p>One of the important things to do during the migration to Angular 2, is add
tests to the whole platform. And the new footer component has its own tests. Its
nothing complex or really &quot;useful&quot;, the tests just check if the <code>version</code>
variable is correctly defined. But this test has an extra purpose, it helps me
to check the test runner and the coverage reporter are working correctly.</p></div></article><aside class="jsx-1828670626  ssr-animation"><a title="Share on Twitter" aria-label="Share on Twitter" target="_blank" href="https://twitter.com/intent/tweet?text=Components migration started&amp;url=https://magarcia.github.io/2016/06/05/component-migration-started&amp;via=martinprins" class="jsx-1828670626"><svg width="20" height="20" viewBox="0 0 24 24" class="jsx-1828670626"><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z" class="jsx-1828670626"></path></svg></a><a title="Share on Facebook" aria-label="Share on Facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://magarcia.github.io/2016/06/05/component-migration-started" class="jsx-1828670626"><svg width="20" height="20" viewBox="0 0 24 24" class="jsx-1828670626"><path d="M22.676 0H1.324C.593 0 0 .593 0 1.324v21.352C0 23.408.593 24 1.324 24h11.494v-9.294H9.689v-3.621h3.129V8.41c0-3.099 1.894-4.785 4.659-4.785 1.325 0 2.464.097 2.796.141v3.24h-1.921c-1.5 0-1.792.721-1.792 1.771v2.311h3.584l-.465 3.63H16.56V24h6.115c.733 0 1.325-.592 1.325-1.324V1.324C24 .593 23.408 0 22.676 0" class="jsx-1828670626"></path></svg></a><a title="Share on LinkedIn" aria-label="Share on LinkedIn" target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://magarcia.github.io/2016/06/05/component-migration-started&amp;title=Components migration started&amp;source=https%3A//www.linkedin.com/in/martingarciamonterde/" class="jsx-1828670626"><svg width="20" height="20" viewBox="0 0 24 24" class="jsx-1828670626"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" class="jsx-1828670626"></path></svg></a></aside></div></section><div class="components-___footer___229iY"><div class="components-___footerContent___3zrKr"><span>Made with ❤️ from Barcelona</span></div></div></div><script>__NEXT_DATA__ = {"props":{"pageProps":{"slug":"component-migration-started","year":"2016","month":"06","day":"05","content":"\nAnother week finished. This past week I could not do as much as I would have\nliked. I still at exam time, so I had to spend much of the time studying. But\neven so, there has been significant progress with regard to the project. We\nhave four important points:\n\n1. Fixed the build process for production.\n1. Added test runner.\n1. Migrated the first component to Angular 2.\n1. Added first test for migrated component.\n\n## Fixing the build process\n\nLast week we had the development environment ready and also, presumably, the\nenvironment for distribute builds. But throughout the week, I noticed that with\ndistribute build, Jangouts have issues with grid elements inside the video chat\nroom. After a while trying different configurations for Webpack, I found that\nthe issues was mainly related with the uglify process.\n\nThe issue was related with the grid layout system of the video room, which is\nimplemented using [angular-gridster](http://manifestwebdesign.github.io/angular-gridster/).\nSo, the problem can come form angular-gridster style or the JavaScript module.\nFirst at all I tried to import directly the CSS of the library without load it\nwith Webpack. This didn't solve anything. Finally I found that instead of include\nthe minified version of the library in `vendors.ts` file, I should use the source\nversion.\n\nThis is a little weird, source and minified version should works equally.\nRegardless of this, using the source version fix the issue and this will not be\na problem because Webpack minify all the code, including `vendor.ts`.\n\n## Adding test runner\n\nThis was easier than I expected. I use the awesome project\n[angular2-webpack-starter](https://github.com/AngularClass/angular2-webpack-starter)\nfrom [@AngularClass](https://angularclass.com/) as a inspiration source for\nimplement the test runner in Jangouts. I get the files `webpack.test.js` and\n`karma.conf.js` and, after some small changes, all worked perfectly. This is one\nof the best things of open source community: Don't Repeat Yourself.\n\n## Migrating first component\n\nI was waiting for this moment since I sent my proposal to GSoC. I started with\nthe migration  of a simple component, probably the simplest component of whole\nJangouts, the footer. The footer in Jangouts only shows a link to\n[SUSE](https://www.suse.com/) and the version of Jangouts.\n\nIn the old Jangouts (I will start to differencate between pre and post migration\nprocess) the footer component was composed by a simple Angular 1 directive with\na template and a [`jade`](http://jade-lang.com/) template, that was rendered by\ngulp adding the current version.\n\nThe new footer component is equally simple. It's a [TypeScript file](https://github.com/magarcia/jangouts/blob/5db2d9de547d6d56aaed90c633b5d98ce64f6219/src/app/components/footer/jh-footer.directive.ts)\n(a component definition with an empty class) and an [Angular 2 template](https://github.com/magarcia/jangouts/blob/5db2d9de547d6d56aaed90c633b5d98ce64f6219/src/app/components/footer/jh-footer.html).\nBut has a difference with the previous version, neither gulp or any other thing\nmodifies the template for add the version. Instead the previous solution, now\nWebpack with the [DefinePlugin](https://webpack.github.io/docs/list-of-plugins.html#defineplugin)\nadd the version as a global constant during the build process, reading the\n`package.json`.\n\nThis has a couple of benefits. First, the footer is now a pure Angular component\nand, in the other hand, its more easy to test.\n\n## Adding tests\n\nOne of the important things to do during the migration to Angular 2, is add\ntests to the whole platform. And the new footer component has its own tests. Its\nnothing complex or really \"useful\", the tests just check if the `version`\nvariable is correctly defined. But this test has an extra purpose, it helps me\nto check the test runner and the coverage reporter are working correctly.\n\n","readingTime":{"text":"3 min read","minutes":2.81,"time":168600,"words":562},"title":"Components migration started"}},"page":"/post","query":{"year":"2016","month":"06","day":"05","id":"component-migration-started"},"buildId":"JoZFjfxwajfkHyjTUvJxP","nextExport":true};__NEXT_LOADED_PAGES__=[];__NEXT_REGISTER_PAGE=function(r,f){__NEXT_LOADED_PAGES__.push([r, f])}</script><script async="" id="__NEXT_PAGE__/post" src="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/post.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/_app.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/_next/static/JoZFjfxwajfkHyjTUvJxP/pages/_error.js"></script><script src="/_next/static/runtime/webpack-1c1c3136e0f7012e8706.js" async=""></script><script src="/_next/static/chunks/commons.fe229520576991e872e2.js" async=""></script><script src="/_next/static/chunks/styles.b51f4f1115dec62a42ce.js" async=""></script><script src="/_next/static/runtime/main-a455fdec3098400745ef.js" async=""></script></body></html>